if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("infercnv")
library(infercnv)
infercnv_obj = CreateInfercnvObject(raw_counts_matrix=system.file("extdata", "oligodendroglioma_expression_downsampled.counts.matrix.gz", package = "infercnv"),
annotations_file=system.file("extdata", "oligodendroglioma_annotations_downsampled.txt", package = "infercnv"),
delim="\t",
gene_order_file=system.file("extdata", "gencode_downsampled.EXAMPLE_ONLY_DONT_REUSE.txt", package = "infercnv"),
ref_group_names=c("Microglia/Macrophage","Oligodendrocytes (non-malignant)"))
infercnv_obj = infercnv::run(infercnv_obj,
cutoff=1, # cutoff=1 works well for Smart-seq2, and cutoff=0.1 works well for 10x Genomics
out_dir=tempfile(),
cluster_by_groups=TRUE,
denoise=TRUE,
HMM=TRUE)
library(copykat)
library(devtools)
install.packages("devtools")
library(devtools)
install_github("navinlabcode/copykat")
install.packages("Seurat")
install.packages("Seurat")
library(Seurat)
install.packages("Seurat")
install.packages("Seurat")
install.packages("Seurat")
install.packages("Seurat")
install.packages("Seurat")
library(Seurat)
install.packages('scPloidy')
setRepositories(ind=1:3) # needed to automatically install Bioconductor dependencies
install.packages("Signac")
library(scPloidy)
library(dplyr)
library(tidyr)
library(gplots)
library(Signac)
library(scPloidy)
library(dplyr)
library(tidyr)
library(gplots)
library(Signac)
library(Seurat)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
has_pkg = requireNamespace("dplyr", quietly = TRUE) &&
requireNamespace("tidyr", quietly = TRUE) &&
requireNamespace("gplots", quietly = TRUE)
knitr::opts_chunk$set(eval = has_pkg)
library(scPloidy)
library(dplyr)
library(tidyr)
library(gplots)
library(Signac)
library(Seurat)
library(EnsDb.Mmusculus.v79)
setwd("~/Documents/Martinez-Jimenez_Lab/scPloidy")
setwd("~/Documents/Martinez-Jimenez_Lab/scPloidy/ATAC_MJ/S1 WT_Young_2n")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("EnsDb.Mmusculus.v79")
library(scPloidy)
library(dplyr)
library(tidyr)
library(gplots)
library(Signac)
library(Seurat)
library(EnsDb.Mmusculus.v79)
library(ggplot2)
library(patchwork)
counts <- Read10X_h5("Partek_ATAC_KOs_22L008026_S1_filtered_peak_bc_matrix.h5")
install.packages("hdf5r")
library(scPloidy)
library(dplyr)
library(tidyr)
library(gplots)
library(Signac)
library(Seurat)
library(EnsDb.Mmusculus.v79)
library(ggplot2)
library(patchwork)
library(hd5r)
library(scPloidy)
library(dplyr)
library(tidyr)
library(gplots)
library(Signac)
library(Seurat)
library(EnsDb.Mmusculus.v79)
library(ggplot2)
library(patchwork)
library(hdf5r)
counts <- Read10X_h5("Partek_ATAC_KOs_22L008026_S1_filtered_peak_bc_matrix.h5")
metadata <- read.csv(
file = "Partek_ATAC_KOs_22L008026_S1_singlecell.csv",
header = TRUE,
row.names = 1
)
liver_assay <- CreateChromatinAssay(
counts = counts,
sep = c(":", "-"),
genome = "mm10",
fragments = 'Partek_ATAC_KOs_22L008026_S1_fragments.tsv.gz',
min.cells = 1
)
liver <- CreateSeuratObject(
counts = liver_assay,
assay = 'peaks',
project = 'ATAC',
meta.data = metadata
)
# extract gene annotations from EnsDb
annotations <- GetGRangesFromEnsDb(ensdb = EnsDb.Mmusculus.v79)
install.packages("hdf5r")
install.packages("biovizBase")
liver <- CreateSeuratObject(
counts = liver_assay,
assay = 'peaks',
project = 'ATAC',
meta.data = metadata
)
# extract gene annotations from EnsDb
annotations <- GetGRangesFromEnsDb(ensdb = EnsDb.Mmusculus.v79)
# change to UCSC style since the data was mapped to hg19
seqlevels(annotations) <- paste0('chr', seqlevels(annotations))
genome(annotations) <- "mm10"
# add the gene information to the object
Annotation(liver) <- annotations
liver <- TSSEnrichment(liver)
# Extract gene annotations from EnsDb
annotations <- GetGRangesFromEnsDb(ensdb = EnsDb.Mmusculus.v79)
# Convert the annotations to match the sequence levels of the assay
seqlevelsStyle(annotations) <- "UCSC" # Change to UCSC style (e.g., chr1, chr2)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
has_pkg = requireNamespace("dplyr", quietly = TRUE) &&
requireNamespace("tidyr", quietly = TRUE) &&
requireNamespace("gplots", quietly = TRUE)
knitr::opts_chunk$set(eval = has_pkg)
library(scPloidy)
library(dplyr)
library(tidyr)
library(gplots)
library(Signac)
library(Seurat)
library(EnsDb.Mmusculus.v79)
library(ggplot2)
library(patchwork)
library(hdf5r)
counts <- Read10X_h5("Partek_ATAC_KOs_22L008026_S1_filtered_peak_bc_matrix.h5")
metadata <- read.csv(
file = "Partek_ATAC_KOs_22L008026_S1_singlecell.csv",
header = TRUE,
row.names = 1
)
liver_assay <- CreateChromatinAssay(
counts = counts,
sep = c(":", "-"),
genome = "mm10",
fragments = 'Partek_ATAC_KOs_22L008026_S1_fragments.tsv.gz',
min.cells = 1
)
liver <- CreateSeuratObject(
counts = liver_assay,
assay = 'peaks',
project = 'ATAC',
meta.data = metadata
)
# extract gene annotations from EnsDb
annotations <- GetGRangesFromEnsDb(ensdb = EnsDb.Mmusculus.v79)
# change to UCSC style since the data was mapped to hg19
seqlevels(annotations) <- paste0('chr', seqlevels(annotations))
genome(annotations) <- "mm10"
# add the gene information to the object
Annotation(liver) <- annotations
View(annotations)
View(liver)
# Proceed with the rest of your analysis
liver <- TSSEnrichment(liver)
